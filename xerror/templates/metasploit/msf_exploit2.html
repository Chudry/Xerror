<!DOCTYPE html>

{% load staticfiles %}
<html lang="en">


<!-- Mirrored from www.wrappixel.com/demos/admin-templates/material-pro/dark/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 May 2020 12:26:28 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicon icon -->
    <!-- <link rel="icon" type="image/png" sizes="16x16" href="https://www.wrappixel.com/demos/admin-templates/material-pro/assets/images/favicon.png"> -->
    <title>Exploitation</title>


     <!-- <link rel="stylesheet" href="{% static "css/bootstrap.min.css" %}" type="text/css" />  -->

      <script src="{% static "js/jquery-2.2.4.min.js" %}" type="text/javascript"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.3/js/tether.min.js" type="text/javascript"></script>
      <script src="{% static "js/bootstrap.min.js" %}" type="text/javascript"></script>
      <script src="{% static "js/reconnecting-websocket.min.js" %}" type="text/javascript"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>






    <link href="{% static "css/stl2.css" %}" rel="stylesheet">
    <link href="{% static "css/colors/green-dark.css" %}" rel="stylesheet">


<style type="text/css">
    
#bck{

background-image: url("{% static 'a.png' %}"),url("{% static 'b.jpeg' %}");
  background-attachment: fixed;
  /*color:white;*/
  /*background-repeat: no-repeat;*/
background-position: center ;
}

</style>


</head>





<body class="fix-header fix-sidebar card-no-border" cz-shortcut-listen="true">







    <div id="main-wrapper">

        <header class="topbar">
            <nav class="">

                <div class="top-navbar navbar navbar-header" style="background: #db9a1aeb;"><!-- ffb22b -->
                    <a class="navbar-brand" href="index.html" style="margin-left:5px;">
                        <!-- Logo icon --><b>
                            <!--You can put here icon as well // <i class="wi wi-sunset"></i> //-->
                            <!-- Dark Logo icon -->

                            <!-- Light Logo icon -->
                             <img src="/static/logo.png" width="50px">
                            </b>
                            <!--End Logo icon -->
                            <!-- Logo text --><span>
              
                                <!-- Light Logo text -->
                                <img src="/static/logo_name.png" class="light-logo" alt="homepage"></span>
                    </a>
                </div>
                <!-- ============================================================== -->
                <!-- End Logo -->
                <!-- ============================================================== -->
                
            </nav>
        </header>
 
        <aside class="left-sidebar">
            <!-- Sidebar scroll-->
            <div class="scroll-sidebar">
                <!-- User profile -->
                <div class="user-profile" style="background: url(https://www.wrappixel.com/demos/admin-templates/material-pro/assets/images/background/user-info.jpg) no-repeat;">
                    <!-- User profile image -->
                    <div class="profile-img"> <img src="https://upload.wikimedia.org/wikipedia/en/thumb/f/fa/COMSATS_Logo.svg/1200px-COMSATS_Logo.svg.png" alt="user"> </div>
                    <!-- User profile text-->
                    <div class="profile-text"> <a href="#" class="dropdown-toggle u-dropdown" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true" ><span style="color: #f7b12c;">Comsats Lahore</span> </a>
                        <div class="dropdown-menu animated flipInY"> <a href="#" class="dropdown-item"><i class="ti-user"></i>
                                My Profile</a> <a href="#" class="dropdown-item"><i class="ti-wallet"></i> My
                                Balance</a>
                            <a href="#" class="dropdown-item"><i class="ti-email"></i> Inbox</a>
                            <div class="dropdown-divider"></div> <a href="#" class="dropdown-item"><i class="ti-settings"></i>
                                Account Setting</a>
                            <div class="dropdown-divider"></div> <a href="l" class="dropdown-item"><i class="fa fa-power-off"></i>
                                Logout</a>
                        </div>
                    </div>
                </div>
                <!-- End User profile text-->
                <!-- Sidebar navigation-->
                <nav class="sidebar-nav">
                    <ul id="sidebarnav">
                        <li class="nav-small-cap">Pentesting Phases</li>
                        <li> <a class="has-arrow waves-effect waves-light" href="{% url 'parsing:nm_scan_index' %}" ><i   class="mdi mdi-account-search active"></i><span class="hide-menu" >Scanning </span></a>
                            
                        </li>
                        <li> <a class="has-arrow waves-effect waves-light" href="{% url 'parsing:openvas_scan_index'  %}" ><i  class="mdi mdi-barcode-scan"></i><span class="hide-menu">Vul Scanning</span></a>
                           
                        </li>
                        <li style="border: 0.1px solid orange;"> <a class="has-arrow waves-effect waves-dark"style="color: #f7b12c;" href="#" ><i  style="color: #f7b12c;" class="mdi mdi-biohazard"></i><span class="hide-menu">Exploitation</span></a>
                           
                        </li>
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-laptop-windows"></i><span class="hide-menu">Sessions </span></a>
                            
                        </li>
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-console"></i><span class="hide-menu">Shells</span></a>
                            
                        </li>
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-file-document"></i><span class="hide-menu">Reports</span></a>
                            
                        </li>

                       
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-widgets"></i><span class="hide-menu">Widgets<!--
                        </li-->
                        </span></a></li><li class="nav-devider"></li><a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false">
                        <li class="nav-small-cap">EXTRA COMPONENTS</li>

             
                        </a><li><a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-web"></i> Web Scanning</a><a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-wifi"></i><span class="hide-menu">Wlan0 Testing</span></a>
                           
                        </li>
            
                    </ul>
                </nav>
                <!-- End Sidebar navigation -->
            </div>
            <!-- End Sidebar scroll-->

            <!-- Bottom points-->
            <div class="sidebar-footer">
                <!-- item--><a href="#" class="link" data-toggle="tooldtip" title="Settings"><i class="ti-settings"></i></a>

                <!-- item--><a href="#" class="link" data-toggle="tooltidp" title="Email"><i class="mdi mdi-gmail"></i></a>

                <!-- item--><a href="#" class="link" data-toggle="tooltip" title="Logout"><i class="mdi mdi-power"></i></a>
            </div>
            <!-- End Bottom points-->
        </aside>

















































        <div class="page-wrapper">
            <!-- ============================================================== -->
            <!-- Container fluid  -->
            <!-- ============================================================== -->
            <div class="container-fluid" id="bck">
                <!-- ============================================================== -->
                <!-- Bread crumb and right sidebar toggle -->
                <!-- ============================================================== -->
                <div class="row page-titles">
                    <div class="col-md-5 col-12 align-self-center">
                        <h3 class="text-themecolor">Exploitation</h3>
                        <ol class="breadcrumb">

                            <li class="breadcrumb-item active">Hone</li>
                            <li class="breadcrumb-item active">Scanning</li>
                            <li class="breadcrumb-item active">Vul Scanning</li>
                            <li class="breadcrumb-item active">Vul Report</li>
                            <li class="breadcrumb-item "><a href="javascript:void(0)">Exploitation</a></li>
                        </ol>
                    </div>
                    <div class="col-md-7 col-12 align-self-center d-none d-md-block">
                        <div class="d-flex mt-2 justify-content-end">
                            <div class="d-flex mr-3 ml-2">
                                <div class="chart-text mr-2">
 
                                </div>
                                <div class="spark-chart">
                                    <div id="monthchart"></div>
                                </div>
                            </div>
                            <div class="d-flex mr-3 ml-2">
                                <div class="chart-text mr-2">
   
                                </div>
                                <div class="spark-chart">
                                    <div id="lastmonthchart"></div>
                                </div>
                            </div>
                            <div class="">

                            </div>
                        </div>
                    </div>
                </div>
                <!-- ============================================================== -->
                <!-- End Bread crumb and right sidebar toggle -->
                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- Start Page Content -->
                <!-- ============================================================== -->
                <!-- Row -->
{% if objerr != 'Requested Object not found' %}
    {% if objerr != 'file not found' %}

                <div class="row">
                    <!-- Column -->
                    <div class="col-lg-4 col-md-12">
                        <div class="car d ca rd-inve rse car d-pri mary">
                            <div class="card-body" style="background: rgba(0, 0, 0, 0.6);">
                                <div class="d-flex">
                                    <div class="mr-3 align-self-center">
                                        <h1 class="text-white"><i class="ti-pie-chart"></i></h1>
                                    </div>
                                    <div>
                                        <h3 class="card-title">Remote Host Exploit Info</h3>
                                        <h6 class="card-subtitle">Phase 3</h6>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-10 align-self-center">

                                        <table class="table" >
                                            <th>
                                                <tr>
                                                    <th>Host ID</th>
                                                    <th>IP address</th>
                                                    <th>Rhost Session</th>
                                                    <th>Check Session</th>
                                                </tr>
                                            </th>
                                            <tbody>
                                                <tr>
                                                    <td>{{ id }}</td>
                                                    <td>{{ ip }}</td>
                                             {% if  mapped.items %}
                                                    <td>
                                                        <ul id="notification_session" >
                                                            Sessions  
                                                        </ul>
                                                    </td>


                                                    <td> 
                                                                   
                                                        <button class="badge badge-danger" style=" padding: 5px;  background-color: black; border: 1px solid orange;"> <a href="{% url 'parsing:msf_session' id %}"> 
                                                        Check Sessions 
                                                    </a> </button>
                                                    </td>
                                            {% endif %}

                                                </tr>

                                            </tbody>
                                        </table>




  
                                    </div>
                                    <div class="col-2 pb-3 pt-2 align-self-center">
                                        <div class="usage chartist-chart" style="height:65px"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br>
                        <br>
                    </div>

                    <!-- Column -->
                    <div class="col-lg-4 col-md-12">
                        <div class="car d ca rd-inve rse car d-pri mary">
                            <div class="card-body" style="background: rgba(0, 0, 0, 0.6);">
                                <div class="d-flex">
                                    <div class="mr-3 align-self-center">
                                        <h1 class="text-white"><i class="ti-crown"></i></h1>
                                    </div>
                                    <div>
                                        <h3 class="card-title">CVE To Exploit Mapping </h3>
                                        <h6 class="card-subtitle">Phase 4</h6>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-10 align-self-center">

                                        <table class="table" >
                                            <th>
                                                <tr>
                                                    <th>Total CVE</th>
                                                    <th>High Severity </th>
                                                    <th>Medium Severity </th>
                                                    <th>Mapped to MSF </th>
                                                </tr>
                                            </th>
                                            <tbody>
                                                <tr>
                                                    <td>{{ id }}</td>
                                                    <td>5</td>
                                                    <td>20</td>
                                             {% if  mapped.items %}
                                                    <td>2</td>
                                            {% endif %}
                                                </tr>
                                            

                                            </tbody>
                                        </table>


  
                                    </div>
                                    <div class="col-2 pb-3 pt-2 align-self-center">
                                        <div class="usage chartist-chart" style="height:65px"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Column -->
                    <div class="col-lg-4 col-md-12">
                        <div class="card card-inverse card-success">
                            <div class="card-body">
                                <div class="d-flex">
                                    <div class="mr-3 align-self-center">
                                        <h1 class="text-white"><i class="icon-cloud-download"></i></h1>
                                    </div>
                                    <div>
                                        <h3 class="card-title">Ajax Request Status</h3>
                                        <h4 class="card-subtitle"> Notifications </h4>
                                    </div>
                                </div>
                                <div class="row">
                                    
                                        <h4 class="font-weight-light text-white text-nowrap text-truncate">
                                            
                                            <ul id="notification_exploit" style="color: black;">
                                                    <!-- append by js  -->
                                             </ul>
                                        </h4>

                                    <div class="col-4 align-self-center">
                                    </div>
                                    <div class="col-8 pb-3 pt-2 text-right">
                                        <div class="spark-count" style="height:65px"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Column -->
                    <!-- Column -->
                    
                    <!-- Column -->
                </div>


            <div class="row">
                    <!-- Column -->
                    <div class="col-lg-8 col-md-12">
                        <div class="card">
                            <div class="card-body" style="background-image:url(" static="" b.jpeg");"="">
                                <div class="row">
                                    <div class="col-12">
                                        <div class="d-flex flex-wrap">
                                            <div>
                                                <h3 class="card-title">Mapped Exploit  </h3>
                                                <h6 class="card-subtitle">Exploits are mapped based on CVE to MSF exploits</h6>
                                            </div>
                                            <div class="ml-auto">
                                                <ul class="list-inline">
                                                    <li class="list-inline-item px-2">
                                                        <h6 class="text-success"><i class="fa fa-circle font-10 mr-2 "></i>Mapped Exploits</h6>
                                                    </li>
                                                    <li class="list-inline-item px-2">
                                                        <h6 class="text-info"><i class="fa fa-circle font-10 mr-2"></i>CVE have Exploit</h6>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="card-body" style="height: 100%;">





    {% if  mapped.items %}
                <table id="task_status" class="table">
                    <thead><center>
                        <tr>
                            <th>Scan ID</th>
                            <th>CVE </th>
                            <th>Port </th>
                            <th>Protocol </th>
                            <th>Severity </th>
                            <!-- <th>Exploit </th> -->
                            <th> <center> Exploit</center>  </th>
                            <th> <center> Action</center>  </th>
                        </tr>
                    </center>
                    </thead>


                    <tbody>
        {% for key, value in mapped.items %}
                                <tr>    
                                    <td> {{id}}</td>
                                            {% for j in value %}
                                                   <td>{{ j }}</td>
                                            {% endfor %}

                                     <td > 
                                       <!-- Button trigger modal -->
                                    <!--     <button type="button" value="{{id}}?{{value}}"class="btn btn-primary"  onClick="exploit_config_clicked(this.value)"  >
                                              Config Exploit
                                        </button>

                                         <button id="exploit-status-{{key}}" id="exploit_rh" value='{{id}}?{{value}}' onClick="exploit_btn_clicked(this.value)" class="btn btn-danger">
                                                 Exploit
                                        </button> -->
                                        <center>
                                           <button type="button" value="{{id}}?{{value}}" class="btn btn-warning"  onClick="exploit_config_clicked(this.value)" style=" padding: 5px;  background-color: black; color: orange; border: 1px solid orange;" >
                                                  Config Exploit
                                            </button>
    |
                                             <button id="exploit-status-{{key}}" id="exploit_rh" value='{{id}}?{{value}}' onClick="exploit_btn_clicked(this.value)" class="btn btn-warning"  onClick="exploit_config_clicked(this.value)" style=" padding: 5px;  color: orange; background-color: black; border: 1px solid orange;" >
                                                     Exploit
                                            </button>
                                        </center>



                                     </td>
                                 <tr>
        {% endfor %}
                    </tbody>
                 </table>
    {% else %}
                <h1> 
                    No Mapped Exploit  
                </h1>
    {% endif %}









                                         </div>

<br>
<br>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <h3 class="card-title">Terminal</h3>
                                <h6 class="card-subtitle">Terminal logs all the actions</h6>
                                <div id="visitor" style="height:290px; width:100%;">
                                        <textarea  id="Exploitation_terminal"  style="background-color: black; color: green; height:100%;width:100%; padding: 25px;">Xerror@W11 #:~> __</textarea>
                                </div>
                            </div>
                            <div class="card-body text-center border-top"></div>
                        </div>
                    </div>
                </div>
                <!-- Row -->
                <!-- Row -->





                <div class="row">
                    <!-- Column -->
                    
                    <div class="col-lg-12 col-md-12">
                        <div class="card-body card">
                            <div class="">
                                <div class="d-flex flex-wrap">









































                                    <div>
                                        <h3 class="card-title">Selected Exploit Config INFO </h3>
                                        <h6 class="card-subtitle">Verify/config the the exploit </h6>
                                    </div>
                                    <div class="ml-auto align-self-center">
                                        <ul class="list-inline mb-0">
                                            <li class="list-inline-item px-2">
                                                <h6 class="text-success"><i class="fa fa-circle font-10 mr-2 "></i>Reports Generated</h6>
                                            </li>
                                            <li class="list-inline-item px-2">
                                                <h6 class="text-info"><i class="fa fa-circle font-10 mr-2"></i> Error in reports  </h6>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="card-body ">

                                    <table id="ips" class="table">
                                                     <thead>
                                                        <tr>
                                                            <th>Remote Host</th>
                                                            <th>RPORT  </th>
                                                            <th>Exploit Name</th>
                                                            <th>Architecture</th>
                                                            <th>Author </th>
                                                            <th>Rank</th>
                                                            <th>Type</th>
                                                            <th>License to</th>
                                                            <th>Description</th>
                                                            <th>Payloads</th>
      
                                                        </tr>
                                                     </thead>
                                                     <tbody>

                                            
                                            <td >
                                                <span id="exploit_rhost"> 
                                                    Rhosts
                                                </span> 
                                            </td>
                                            <td >
                                                <span id="exploit_rport"> 
                                                    issue date
                                                </span> 
                                            </td>

                                            <td >
                                                <span id="exploit_name" > 
                                                      name 
                                                 </span>
                                             </td>

                                            <td  >
                                                <span id="exploit_archi"> 
                                                    Archi
                                                </span> 
                                            </td>
                                            <td >
                                                <span id="exploit_author"> 
                                                    Author
                                                </span> 
                                            </td>

                                            <td >
                                                 <span id="exploit_rank"> 
                                                    Rank
                                                </span> 
                                            </td>

                                            <td >
                                                <span id="exploit_type"> 
                                                     type
                                                </span> 
                                            </td>
                                            
                                            <td >
                                             <span id="exploit_license"> 
                                                    license
                                                </span> 
                                            </td>
                                            <td >
                                                <span id="exploit_desc"> 
                                                    description 
                                                </span> 
                                            </td>



                                            <td>
                                                <ol id="exploit_payload"> 
                                                Payloads
                                                </ol> 
                                            <ol id="exploit_payload" >
                                                    <!-- append by js  -->
                                             </ol>



                                            </td>



                                                     </tbody>
                                     </table>

                                 </div>
                                <div class="row text-center">
                                    <div class="col-lg-4 col-md-4 mt-3">
                                        <h1 class="mb-0 font-weight-light"></h1><small>Total Scan</small>
                                    </div>
                                    <div class="col-lg-4 col-md-4 mt-3">
                                        <h1 class="mb-0 font-weight-light"></h1><small>Reporte Generated</small>
                                    </div>
                                    <div class="col-lg-4 col-md-4 mt-3">
                                        <h1 class="mb-0 font-weight-light"></h1><small>Pending</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


        {% else %} <!-- else for  requested object file not found   -->



                    <div class="col-lg-12 col-md-12">
                        <div class="card-body card">
                            <div class="">
                                <div class="d-flex flex-wrap">
                            
                                    <h1> <center> Requested file  not found </center> </h1>
                                    <br><br><br><br><br><br><br><br><br>
                                </div>
                            </div>
                        </div>
                    </div>



            {% endif %} <!-- end of file not foun d  -->
{% else %}<!-- else for object not found   -->

                    <div class="col-lg-12 col-md-12">
                        <div class="card-body card">
                            <div class="">
                                <div class="d-flex flex-wrap">
                            

                                    <h1> <center> Requested object not found </center> </h1>
                                        <br><br><br><br><br><br><br><br>
                                </div>
                            </div>
                        </div>
                    </div>



{% endif  %} <!-- end of object not found   -->
 <div class="row">
                    <!-- Column -->
                    
                <!-- Row -->
                
                <!-- Row -->
                <!-- Row -->
                
                <!-- ============================================================== -->
                <!-- End PAge Content -->
                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- Right sidebar -->
                <!-- ============================================================== -->
                <!-- .right-sidebar -->
                
                <!-- ============================================================== -->
                <!-- End Right sidebar -->
                <!-- ============================================================== -->
            </div>
            <!-- ============================================================== -->
            <!-- End Container fluid  -->
            <!-- ============================================================== -->
            <!-- ============================================================== -->
            <!-- footer -->
            <!-- ============================================================== -->
            <footer class="footer">
                Â© 2020 Xerror Pentest tool  by Xerror Tech Sol's
            </footer>
            <!-- ============================================================== -->
            <!-- End footer -->
            <!-- ============================================================== -->
        </div>
        <!-- ============================================================== -->
        <!-- End Page wrapper  -->
        <!-- ============================================================== -->
    </div>



<!-- Mirrored from www.wrappixel.com/demos/admin-templates/material-pro/dark/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 May 2020 12:28:49 GMT -->


<!-- Mirrored from www.wrappixel.com/demos/admin-templates/material-pro/dark/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 May 2020 12:28:49 GMT -->




<script type="text/javascript">

btn3 = document.getElementById("btnsave");


    btn3.onclick = function() {
  alert("sadf")
}



  function exploit_config_clicked(clicked_id)
  {

        $.ajax({
            
            method:'POST',
            url: '/msf_exploit_config_ajx/',
            data: clicked_id,

            success: handleSuccess,
            error: handleError,
        });
      // alert(clicked_id);

            var node = document.createElement("LI");
            var textnode = document.createTextNode("Sending ajax request");
            node.appendChild(textnode);
            document.getElementById("notification_exploit").appendChild(node); 

        function handleSuccess(data){
            // alert(data.msg)

            var node = document.createElement("LI");
            var textnode = document.createTextNode("System: Precessing request please keep patience");
            node.appendChild(textnode);
            document.getElementById("notification_exploit").appendChild(node); 


            console.log(data.msg);
            $myForm[0].reset()
        }
        function handleError(ThrowError){
            console.log(ThrowError);
        }

  }//end exploit config



  function exploit_btn_clicked(clicked_id)
  {
      alert("exploit clicker ");

            var node = document.createElement("LI");
            var textnode = document.createTextNode("Seding System Exploitation request ");
            node.appendChild(textnode);
            document.getElementById('notification_exploit').appendChild(node); 

        $.ajax({
            
            method:'POST',
            url: '/msf_exploit_ajx/',
            data: clicked_id,

            success: handleSuccess,
            error: handleError,
        });
        function handleSuccess(data){
            alert(data.msg)

            var node = document.createElement("LI");
            var textnode = document.createTextNode(data.msg);
            node.appendChild(textnode);
            document.getElementById("notification_exploit").appendChild(node); 

            console.log(data.msg);
            $myForm[0].reset()
        }
        function handleError(ThrowError){
            console.log(ThrowError);
        }

  }//end exploit clided 


  function config_click(clicked_id)
  {
      // alert(clicked_id);

            var node = document.createElement("LI");
            var textnode = document.createTextNode("Sending Exploit config req ");
            node.appendChild(textnode);
            document.getElementById(clicked_id).appendChild(node); 

        $.ajax({
            
            method:'POST',
            url: '/msf_exploit_ajx/',
            data: clicked_id,

            success: handleSuccess,
            error: handleError,
        });
        function handleSuccess(data){
            // alert(data.msg)

            var node = document.createElement("LI");
            var textnode = document.createTextNode("System processing exploit config req, keep patience");
            node.appendChild(textnode);
            document.getElementById(data.msg).appendChild(node); 

            console.log(data.msg);
            $myForm[0].reset()
        }
        function handleError(ThrowError){
            console.log(ThrowError);
        }

  }
</script>


</script>


<script>
// For production move script to separate *.js file and include here
$(function() {




    // When we're using HTTPS, use WSS too.
    var ws_scheme = window.location.protocol == "https:" ? "wss" : "ws";
    var ws_path = ws_scheme + '://' + window.location.host + '/pool/';
    console.log("Connecting to " + ws_path)

    var socket = new ReconnectingWebSocket(ws_path);
    socket.onmessage = function(message) {
      // Catch websocket messages
        console.log("Got message: " + message.data);

        var data = JSON.parse(message.data);
        if (data.action == "uploaded"){
          // After uploading file change table id's to real file id
                $('input[type=file]').val('')
                var item = $('#process-' + data.file_id);
                $('#file-' + data.file_id).text(data.new_file_id)
                $('#file-' + data.file_id).attr("id", "file-" + data.new_file_id);
                $('#process-' + data.file_id).attr("id", "process-" + data.new_file_id);
                $('#result-' + data.file_id).attr("id", "result-" + data.new_file_id);

            // alert(data.file_id)


        }

        else if (data.action == "taken_ip") {

            var task_status = $("#task_status");
            var ele = $('<tr></tr>');
            ele.attr("id", data.job_id);

            var item_id = $("<td></td>").text(data.job_id);
            ele.append(item_id);

            var item_name = $("<td></td>").text(data.job_name);
            ele.append(item_name);

            var item_status = $("<td ></td>");
            item_status.attr("id", "status-"+data.job_id);
            var span = $('<span class="label label-primary"> %</span>').text(data.job_status);

            item_status.append(span);
            ele.append(item_status);
            task_status.append(ele);
        }//other file


        else if (data.action == "exploiting_remort_host"){
          // Draw celery task progress
            

            var node = document.createElement("LI");
            var textnode = document.createTextNode(data.msf_exploit_current_status);
            node.appendChild(textnode);

            document.getElementById("notification_exploit").appendChild(node); 
            if (data.sessions){ 
                var node = document.createElement("LI");
                var textnode = document.createTextNode(data.sessions);
                node.appendChild(textnode);
                document.getElementById("notification_session").appendChild(node); 
            }


            document.getElementById("Exploitation_terminal").value +=data.msf_exploit_current_status

            $('#Exploitation_terminal').scrollTop($('#Exploitation_terminal')[0].scrollHeight);
            
              var item = $('#exploit-status-' + data.job_id );
            item.attr("class", "btn btn-primary "); 
            item.text(data.job_status);


var lnk = document.getElementById('exploit_rh');

    if (window.addEventListener) {
        document.addEventListener('click', function (e) {
            if (e.target.id === lnk.id) {
                e.preventDefault();         // Comment this line to enable the link tag again.
            }
        });
    }






        }

        else if (data.action == "exploiting_config_exploit"){
          // Draw celery task progress
            var node = document.createElement("LI");
            var textnode = document.createTextNode("Exploit config info loaded succesfully");
            node.appendChild(textnode);
            document.getElementById("notification_exploit").appendChild(node); 
            document.getElementById("Exploitation_terminal").value +=data.msf_exploit_config_current_status

            $('#Exploitation_terminal').scrollTop($('#Exploitation_terminal')[0].scrollHeight);
            
            var item = $('#exploit_archi');
            item.text(data.archi);

            var item = $('#exploit_name');
            item.text(data.name);

            var item = $('#exploit_author');
            item.text(data.authors);

            var item = $('#exploit_rport');
            item.text(data.rport);

            var item = $('#exploit_rank');
            item.text(data.rank);

            var item = $('#exploit_type');
            item.text(data.type_);

            var item = $('#exploit_rhost');
            item.text(data.rhosts);



            var item = $('#exploit_license');
            item.text(data.license);



            var item = $('#exploit_desc');
            item.text(data.desc);



            // var item = $('#exploit_payload');
            // item.text(data.payloads);
        }



        else if (data.action == "exploiting_config_exploit_payloads"){
          // Draw celery task progress



            // alert(data.payloads)
            var node = document.createElement("LI");
            var textnode = document.createTextNode(data.payloads);
            node.appendChild(textnode);
            document.getElementById("exploit_payload").appendChild(node); 


            // var item = $('#exploit_payload');
            // item.text(data.payloads);
        }







































        else if (data.action == "completed_ip"){
          // Draw celery task progress
            var item = $('#status-' + data.job_id );
            item.attr("class", "label label-success");
            item.text(data.job_status);

            // var item = $('#process-' + data.file_id);
            // item.text(data.progress + ' %');
        }



        else if (data.action == "processing"){
          // Draw celery task progress
            var item = $('#process-' + data.file_id);
            item.text(data.progress + ' %');
        }

        else if (data.action == "completed"){
          // Draw celery task result
            var item = $('#result-' + data.file_id);
            item.text(data.file_amount);
        }
    };//end of onmessage

});//end of main funciton  

</script>


</body>
</html>