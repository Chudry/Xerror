<!DOCTYPE html>

{% load staticfiles %}
<html lang="en">


<!-- Mirrored from www.wrappixel.com/demos/admin-templates/material-pro/dark/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 May 2020 12:26:28 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicon icon -->
    <!-- <link rel="icon" type="image/png" sizes="16x16" href="https://www.wrappixel.com/demos/admin-templates/material-pro/assets/images/favicon.png"> -->
    <title>Vul Scanning</title>


     <!-- <link rel="stylesheet" href="{% static "css/bootstrap.min.css" %}" type="text/css" />  -->

      <script src="{% static "js/jquery-2.2.4.min.js" %}" type="text/javascript"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.3/js/tether.min.js" type="text/javascript"></script>
      <script src="{% static "js/bootstrap.min.js" %}" type="text/javascript"></script>
      <script src="{% static "js/reconnecting-websocket.min.js" %}" type="text/javascript"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>






    <link href="{% static "css/stl2.css" %}" rel="stylesheet">
    <link href="{% static "css/colors/green-dark.css" %}" rel="stylesheet">


<style type="text/css">
    
#bck{

background-image: url("{% static 'a.png' %}");
  background-attachment: fixed;
  /*color:white;*/
  background-repeat: no-repeat;
background-position: center ;
}


#def{

background-image: url("{% static 'b.jpeg' %}");
  
}



</style>


</head>





<body class="fix-header fix-sidebar card-no-border" cz-shortcut-listen="true">


    <div id="main-wrapper">

        <header class="topbar">
            <nav class="">

                <div class="top-navbar navbar navbar-header" style="background: #db9a1aeb;"><!-- ffb22b -->
                    <a class="navbar-brand" href="index.html" style="margin-left:5px;">
                        <!-- Logo icon --><b>
                            <!--You can put here icon as well // <i class="wi wi-sunset"></i> //-->
                            <!-- Dark Logo icon -->

                            <!-- Light Logo icon -->
                            <img src="{% static 'logo.png' %}" width="50px">
                            </b>
                            <!--End Logo icon -->
                            <!-- Logo text --><span>
              
                                <!-- Light Logo text -->
                                <img src="{% static 'logo_name.png' %}" class="light-logo" alt="homepage"></span>
                        
                    </a>
                </div>
                <!-- ============================================================== -->
                <!-- End Logo -->
                <!-- ============================================================== -->
                
            </nav>
        </header>
 
        <aside class="left-sidebar">
            <!-- Sidebar scroll-->
            <div class="scroll-sidebar">
                <!-- User profile -->
                <div class="user-profile" style="background: url(https://www.wrappixel.com/demos/admin-templates/material-pro/assets/images/background/user-info.jpg) no-repeat;">
                    <!-- User profile image -->
                    <div class="profile-img"> <img src="https://upload.wikimedia.org/wikipedia/en/thumb/f/fa/COMSATS_Logo.svg/1200px-COMSATS_Logo.svg.png" alt="user"> </div>
                    <!-- User profile text-->
                    <div class="profile-text"> <a href="#" class="dropdown-toggle u-dropdown" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true" ><span style="color: #f7b12c;">Comsats Lahore</span> </a>
                        <div class="dropdown-menu animated flipInY"> <a href="#" class="dropdown-item"><i class="ti-user"></i>
                                My Profile</a> <a href="#" class="dropdown-item"><i class="ti-wallet"></i> My
                                Balance</a>
                            <a href="#" class="dropdown-item"><i class="ti-email"></i> Inbox</a>
                            <div class="dropdown-divider"></div> <a href="#" class="dropdown-item"><i class="ti-settings"></i>
                                Account Setting</a>
                            <div class="dropdown-divider"></div> <a href="l" class="dropdown-item"><i class="fa fa-power-off"></i>
                                Logout</a>
                        </div>
                    </div>
                </div>
                <!-- End User profile text-->
                <!-- Sidebar navigation-->
                <nav class="sidebar-nav">
                    <ul id="sidebarnav">
                        <li class="nav-small-cap">Pentesting Phases</li>
                         <li> <a class="has-arrow waves-effect waves-light"  href="/" ><i   class="mdi mdi-view-dashboard"></i><span class="hide-menu" >Dashboard </span></a>
                        </li>

                        <li> <a class="has-arrow waves-effect waves-light" href="{% url 'parsing:nm_scan_index' %}" ><i   class="mdi mdi-account-search active"></i><span class="hide-menu" >Scanning </span></a>
                            
                        </li>
                        <li> <a class="has-arrow waves-effect waves-light" style="color: #f7b12c;" href="{% url 'parsing:openvas_scan_index'  %}" ><i  style="color: #f7b12c;" class="mdi mdi-barcode-scan"></i><span class="hide-menu">Vul Scanning</span></a>
                           
                        </li>
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-biohazard"></i><span class="hide-menu">Exploitation</span></a>
                           
                        </li>
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-laptop-windows"></i><span class="hide-menu">Sessions </span></a>
                            
                        </li>
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-console"></i><span class="hide-menu">Shells</span></a>
                            
                        </li>
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-file-document"></i><span class="hide-menu">Reports</span></a>
                            
                        </li>

                       
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-widgets"></i><span class="hide-menu">Widgets<!--
                        </li-->
                        </span></a></li><li class="nav-devider"></li><a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false">
                        <li class="nav-small-cap">EXTRA COMPONENTS</li>

             
                        </a><li><a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-web"></i> Web Scanning</a><a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-wifi"></i><span class="hide-menu">Wlan0 Testing</span></a>
                           
                        </li>
            
                    </ul>
                </nav>
                <!-- End Sidebar navigation -->
            </div>
            <!-- End Sidebar scroll-->

            <!-- Bottom points-->
            <div class="sidebar-footer">
                <!-- item--><a href="#" class="link" data-toggle="tooldtip" title="Settings"><i class="ti-settings"></i></a>

                <!-- item--><a href="#" class="link" data-toggle="tooltidp" title="Email"><i class="mdi mdi-gmail"></i></a>

                <!-- item--><a href="#" class="link" data-toggle="tooltip" title="Logout"><i class="mdi mdi-power"></i></a>
            </div>
            <!-- End Bottom points-->
        </aside>

















































        <div class="page-wrapper" id="def">
            <!-- ============================================================== -->
            <!-- Container fluid  -->
            <!-- ============================================================== -->
            <div class="container-fluid" id="bck">
                <!-- ============================================================== -->
                <!-- Bread crumb and right sidebar toggle -->
                <!-- ============================================================== -->
                <div class="row page-titles">
                    <div class="col-md-5 col-12 align-self-center">
                        <h3 class="text-themecolor">Vulnerability Scanning</h3>
                        <ol class="breadcrumb">

                            <li class="breadcrumb-item active">Hone</li>
                            <li class="breadcrumb-item active">Scanning</li>
                            <li class="breadcrumb-item "><a href="javascript:void(0)">Vul Scanning</a></li>
                        </ol>
                    </div>
                    <div class="col-md-7 col-12 align-self-center d-none d-md-block">
                        <div class="d-flex mt-2 justify-content-end">
                            <div class="d-flex mr-3 ml-2">
                                <div class="chart-text mr-2">
 
                                </div>
                                <div class="spark-chart">
                                    <div id="monthchart"></div>
                                </div>
                            </div>
                            <div class="d-flex mr-3 ml-2">
                                <div class="chart-text mr-2">
   
                                </div>
                                <div class="spark-chart">
                                    <div id="lastmonthchart"></div>
                                </div>
                            </div>
                            <div class="">

                            </div>
                        </div>
                    </div>
                </div>
                <!-- ============================================================== -->
                <!-- End Bread crumb and right sidebar toggle -->
                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- Start Page Content -->
                <!-- ============================================================== -->
                <!-- Row -->
                <div class="row">
                    <!-- Column -->
                    <div class="col-lg-8 col-md-12">
                        <div class="car d ca rd-inve rse car d-pri mary">
                            <div class="card-body" style="background: rgba(0, 0, 0, 0.6);">
                                <div class="d-flex">
                                    <div class="mr-3 align-self-center">
                                        <h1 class="text-white"><i class="ti-pie-chart"></i></h1>
                                    </div>
                                    <div>
                                        <h3 class="card-title">Scan Vulnerability in Remort Host</h3>
                                        <h6 class="card-subtitle">Phase 2</h6>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-10 align-self-center">


<form class="form-inline openvas-ajax-form" method="POST" data-url="/openvas_ajx/">
                {% csrf_token %}
 
  <div class="form-group mx-sm-3 mb-2">
    <input type="text" class="form-control" minlength="7" name="host_ip" id="host_ip" maxlength="15" size="15" pattern="^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$">
  </div>
  <button type="submit" value="submit" class="btn btn-info mb-2">Start Scanning</button>
</form>

<!-- 
            <form method="POST" class="form-inline my-ajax-form" data-url="/nmap_ajx/">
                {% csrf_token %}
                <input type="text" minlength="7" name="host_ip" id="host_ip" maxlength="15" size="15" pattern="^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$">
                <input type="submit" value="submit" class="btn btn-primary" name="">
            </form> -->
 



                                    </div>
                                    <div class="col-2 pb-3 pt-2 align-self-center">
                                        <div class="usage chartist-chart" style="height:65px"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Column -->
                    <!-- Column -->
                    <div class="col-lg-4 col-md-12">
                        <div class="card card-inverse card-success">
                            <div class="card-body">
                                <div class="d-flex">
                                    <div class="mr-3 align-self-center">
                                        <h1 class="text-white"><i class="icon-cloud-download"></i></h1>
                                    </div>
                                    <div>
                                        <h3 class="card-title">Ajax Request Status</h3>
                                        <h4 class="card-subtitle"> Notifications </h4>
                                    </div>
                                </div>
                                <div class="row">
                                    
                                        <h4 class="font-weight-light text-white text-nowrap text-truncate">
                                            
                                            <ul id="notification_opv" style="color: black;">
                                                    <!-- append by js  -->
                                             </ul>
                                        </h4>
 
                                    <div class="col-4 align-self-center">
                                    </div>
                                    <div class="col-8 pb-3 pt-2 text-right">
                                        <div class="spark-count" style="height:65px"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Column -->
                    <!-- Column -->
                    
                    <!-- Column -->
                </div>


            <div class="row">
                    <!-- Column -->
                    <div class="col-lg-8 col-md-12">
                        <div class="card">
                            <div class="card-body" style="background-image:url(" static="" b.jpeg");"="">
                                <div class="row">
                                    <div class="col-12">
                                        <div class="d-flex flex-wrap">
                                            <div>
                                                <h3 class="card-title">Running/Pending Scan Status </h3>
                                                <h6 class="card-subtitle">They are sync you may browser other pages</h6>
                                            </div>
                                            <div class="ml-auto">
                                                <ul class="list-inline">
                                                    <li class="list-inline-item px-2">
                                                        <h6 class="text-success"><i class="fa fa-circle font-10 mr-2 "></i>Running</h6>
                                                    </li>
                                                    <li class="list-inline-item px-2">
                                                        <h6 class="text-info"><i class="fa fa-circle font-10 mr-2"></i>Retired</h6>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="card-body" style="height: 100%;">
                                            <table id="openvas_task_status" class="table">
                                                <thead>
                                                    <tr>
                                                        <th>Scan ID</th>
                                                        <th>IP Address</th>
                                                        <th>Scanning Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for ip in job%}
                                                        {% if ip.vul_status != "no" %}
                                                        <tr>
                                                            {% if ip.status == "started" %} 
                                                            <td>{{ ip.id }}</td>
                                                            <td>{{ ip.name }}</td>
                                                            <td id="status-{{ ip.id }}">
                                                                    <span class="badge badge-primary"> 

                                                                      {{ ip.status}} 
                                                                  </span>
                                                             </td>
                                                            {% else %} {{ continue }}
                                                            {% endif%}
                                                        </tr>
                                                        {% endif %}
                                                    {% endfor %}
                                                </tbody>
                                             </table>
                                         </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <h3 class="card-title">Terminal</h3>
                                <h6 class="card-subtitle">Terminal logs all the actions</h6>
                                <div id="visitor" style="height:290px; width:100%;">
                                        <textarea id="openvas_resul_Terminal"  style="background-color: black; color: green; height:100%;width:100%; padding: 25px;">Xerror@W11 #:~> __</textarea>
                                </div>
                            </div>
                            <div class="card-body text-center border-top"></div>
                        </div>
                    </div>
                </div>
                <!-- Row -->
                <!-- Row -->
                <div class="row">
                    <!-- Column -->
                    
                    <div class="col-lg-12 col-md-12">
                        <div class="card-body card">
                            <div class="">
                                <div class="d-flex flex-wrap">
                                    <div>
                                        <h3 class="card-title">Completed Vulnerability Scanes</h3>
                                        <h6 class="card-subtitle">Complete vulnerability reports, click on ip</h6>
                                    </div>
                                    <div class="ml-auto align-self-center">
                                        <ul class="list-inline mb-0">
                                            <li class="list-inline-item px-2">
                                                <h6 class="text-success"><i class="fa fa-circle font-10 mr-2 "></i>Reports Generated</h6>
                                            </li>
                                            <li class="list-inline-item px-2">
                                                <h6 class="text-info"><i class="fa fa-circle font-10 mr-2"></i> Error in reports  </h6>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="card-body ">

                                    <table id="ips" class="table">
                                                     <thead>
                                                        <tr>
                                                            <th>Scan ID</th>
                                                            <th>Ip Address</th>
                                                            <th>Nmap Scan Report </th>
                                                            <th>OpenVas Scan Status </th>
                                                            <th>Exploitation Status </th>
                                                            <th>Vulnerability Scan Status  </th>

                                                            <th> status </th>
                                                        </tr>
                                                     </thead>
                                                     <tbody>
                                                        {% for file in job%}
                                                            <tr>
                                                                <!-- <td id="status-{{ file.id }}"> -->
                                                                <!-- {% if file.status == "completed" %}  -->

                                                                <td>{{ file.id }}</td>
                                                                <td> {{ file.name }}</td>
                                                                <!-- <td> 100 %</td> -->
                                                                <!-- <td id="status-{{ file.id }}"> -->
                                                                <!-- {% if file.status == started %} -->
                                                                 ? %
                                                                <!-- {% else %} -->
                                                                <!-- {% endif%}</td> -->
                                                                <!-- <td id="status-{{ file.id }}">{{ file.status }}</td> -->
                                                                <!-- <td id="result-{{ file.id }}">{{ file.amount }}</td> -->

                                                                <td><a href="{% url 'parsing:nm_ip_detailed' file.id %}"> {{ file.nm_status }}</a></td>   

                                                                <td> {{file.vul_status}} </td>                       
                                                                <td> {{file.exploit_status}} </td>                       
                                                                <td id="status-{{ file.id }}">
                                                                        <span class="badge badge-info text-light"> 

                                                                     {{ file.status}} 
                                                                 </span>
                                                                     </td>


                                                                 <td>
                                                                    <span class="badge badge-warning" style=" color: orange; background: black; border: 1px solid orange; padding: 8px;">
                                                                         <a href="{% url 'parsing:openvas_ip_detailed' file.id %}">
                                                                            Get it
                                                                        </a>
                                                                    </span>
                                                                </td>

                                                                <!-- {% endif%} -->

                                                            </tr>
                                                        {% endfor %}
                                                </tbody>
                                         </table>

                                      </div>
                                <div class="row text-center">
                                    <div class="col-lg-4 col-md-4 mt-3">
                                        <h1 class="mb-0 font-weight-light">81</h1><small>Total Scan</small>
                                    </div>
                                    <div class="col-lg-4 col-md-4 mt-3">
                                        <h1 class="mb-0 font-weight-light">67</h1><small>Reporte Generated</small>
                                    </div>
                                    <div class="col-lg-4 col-md-4 mt-3">
                                        <h1 class="mb-0 font-weight-light">14</h1><small>Pending</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Row -->
                
                <!-- Row -->
                <!-- Row -->
                
                <!-- ============================================================== -->
                <!-- End PAge Content -->
                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- Right sidebar -->
                <!-- ============================================================== -->
                <!-- .right-sidebar -->
                
                <!-- ============================================================== -->
                <!-- End Right sidebar -->
                <!-- ============================================================== -->
            </div>
            <!-- ============================================================== -->
            <!-- End Container fluid  -->
            <!-- ============================================================== -->
            <!-- ============================================================== -->
            <!-- footer -->
            <!-- ============================================================== -->
            <footer class="footer">
                Â© 2020 Xerror Pentest tool  by Xerror Tech Sol's
            </footer>
            <!-- ============================================================== -->
            <!-- End footer -->
            <!-- ============================================================== -->
        </div>
        <!-- ============================================================== -->
        <!-- End Page wrapper  -->
        <!-- ============================================================== -->
    </div>



<!-- Mirrored from www.wrappixel.com/demos/admin-templates/material-pro/dark/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 May 2020 12:28:49 GMT -->


<!-- Mirrored from www.wrappixel.com/demos/admin-templates/material-pro/dark/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 May 2020 12:28:49 GMT -->

<script>
// For production move script to separate *.js file and include here
$(function() {


    // function uploadFiles(event) {
    //   // Upload via AJAX
    //   event.stopPropagation(); // Stop stuff happening
    //     event.preventDefault(); // Totally stop stuff happening

    //         var $myForm = $('.openvas-ajax-form');
    //         var $formData = $myForm.serialize();

    //     if (files != undefined) {
    //         $.ajax({
    //             method: 'POST',
    //             url: '/upload/',
    //             data: $formData,
    //             cache: false,
    //             dataType: 'json',
    //             processData: false, 
    //             contentType: false,    

    //             success: function(data)
    //             {   

    //                 alert(data.msg)

    //             },
    //         });
    //     }
    // }//end of function upload file 

$(document).ready(function(){
    var $myForm = $('.openvas-ajax-form');
    $myForm.submit(function(event){
        // event.preventDefault();
         event.stopPropagation(); // Stop stuff happening
        event.preventDefault(); // Totally stop stuff happening
        var $formData = $myForm.serialize();
        var $thisURL = $myForm.attr('data-url') || window.loaction.href;
        $.ajax({
            
            method:'POST',
            url: $thisURL,
            data: $formData,

            success: handleSuccess,
            error: handleError,
        });
        function handleSuccess(data){
            alert(data.msg)

              var node = document.createElement("LI");
              var textnode = document.createTextNode(data.msg);
              node.appendChild(textnode);
              document.getElementById("notification_opv").appendChild(node);  
            
            console.log(data.msg);
            $myForm[0].reset()
        }
        function handleError(ThrowError){
                var node = document.createElement("LI");
              var textnode = document.createTextNode(ThrowError.msg);
              node.appendChild(textnode);
              document.getElementById("notification_opv").appendChild(node);  

            console.log(ThrowError);
        }
    });
});






    // When we're using HTTPS, use WSS too.
    var ws_scheme = window.location.protocol == "https:" ? "wss" : "ws";
    var ws_path = ws_scheme + '://' + window.location.host + '/pool/';
    console.log("Connecting to " + ws_path)

    var socket = new ReconnectingWebSocket(ws_path);
    socket.onmessage = function(message) {
      // Catch websocket messages
        console.log("Got message: " + message.data);

        var data = JSON.parse(message.data);
        if (data.action == "openvas_taken_ip") {
            alert("taken_ipp")

             var node = document.createElement("LI");
              var textnode = document.createTextNode("System Recived IP ");
              node.appendChild(textnode);
              document.getElementById("notification_opv").appendChild(node);  

            var openvas_task_status = $("#openvas_task_status");
            var ele = $('<tr></tr>');
            ele.attr("id", data.job_id);

            var item_id = $("<td></td>").text(data.job_id);
            ele.append(item_id);

            var item_name = $("<td></td>").text(data.job_name);
            ele.append(item_name);

            var item_status = $("<td ></td>");
            item_status.attr("id", "status-"+data.job_id);
            var span = $('<span class="badge badge-primary"> %</span>').text(data.job_status);

            item_status.append(span);
            ele.append(item_status);
            openvas_task_status.append(ele);
        }//other file


        else if (data.action == "openvas_running_status"){
          // Draw celery task progress
            document.getElementById("openvas_resul_Terminal").value +=data.job_openvas_log

            $('#openvas_resul_Terminal').scrollTop($('#openvas_resul_Terminal')[0].scrollHeight);
            
            var item = $('#status-' + data.job_id );
            item.attr("class", "badge badge-info");
            item.text(data.job_openvas_current_status);

        }



        else if (data.action == "completed_ip"){
          // Draw celery task progress
            var item = $('#status-' + data.job_id );
            item.attr("class", "badge badge-success");
            item.text(data.job_status);

            // var item = $('#process-' + data.file_id);
            // item.text(data.progress + ' %');
        }

        else if (data.action == "openvas_host_up_check"){
            alert(data.check_status);
             var node = document.createElement("LI");
              var textnode = document.createTextNode(data.check_status);
              node.appendChild(textnode);
              document.getElementById("notification_opv").appendChild(node);  

        }



        else if (data.action == "processing"){
          // Draw celery task progress
            var item = $('#process-' + data.file_id);
            item.text(data.progress + ' %');
        }

        else if (data.action == "completed"){
          // Draw celery task result
            var item = $('#result-' + data.file_id);
            item.text(data.file_amount);
        }
    };//end of onmessage

});//end of main funciton  

</script>



</body>
</html>